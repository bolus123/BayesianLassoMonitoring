bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
dim(X1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb
Y1
Y1[8]
bb$Z[8, ]
hisT(bb$Z[8, ])
hist(bb$Z[8, ])
hist(bb$Z[127, ])
bb$theta
bb$Zeta
bb$Beta
bb$Zeta * bb$Beta
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
NULL)
bb1 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
NULL)
bb2 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
H1)
bb3 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb$Gamma
bb$Zeta
bb$Tau
bb$Beta
bb1$Tau
bb1$Gamma
bb1$Zeta
bb1$Beta
bb2$Zeta
bb$Tau
bb2$Tau
bb2$Gamma
bb2$Zeta
bb2$Beta
cc <- simYph2(0, as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]),
as.matrix(bb$Mu[, 1]), bb$sigma2[1],
1, bb$theta[1], 1, 0, 1e-32)
cc
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- simYph2(0, as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]),
as.matrix(bb$Mu[, 1]), bb$sigma2[1],
1, bb$theta[1], 1, 0, 1e-32)
cc
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
cc1 <- simYph2(0, as.matrix(Y1), as.matrix(bb1$Z[, 1]), as.matrix(bb1$Phi[, 1]),
as.matrix(bb1$Mu[, 1]), bb1$sigma2[1],
1, bb1$theta[1], 1, 0, 1e-32)
cc1
cc1
plot(cc1)
plot(cc1)
plot(Y1)
points(cc1, col = 'red')
bb1$theta
plot(Y1, type = 'l')
points(cc1, col = 'red', type = 'l')
bb2$Gamma
bb2$Gamma * bb2$Tau
rowMeans(updatemu0MuX)
rowMeans(bb2$Gamma * bb2$Tau)
plot(bb2$Gamma * bb2$Tau)
plot(rowMeans(bb2$Gamma * bb2$Tau))
rowMeans(bb2$Mu + H1 %*% (bb2$Gamma * bb2$Tau)))
rowMeans(bb2$Mu + H1 %*% (bb2$Gamma * bb2$Tau))
plot(rowMeans(bb2$Mu + H1 %*% (bb2$Gamma * bb2$Tau)))
object$coef
object$coef
bb2$Phi[1, ]
hist(bb2$Phi[1, ])
hist(bb2$Phi[1, ])
bb2$mu0
object$coef
rowMeans(bb2$Zeta * bb2$Beta)
rowMeans(bb3$Zeta * bb3$Beta)
hist(object$x)
yeojohntr(hist(object$x), median(bb3$theta), 1e-32)
yeojohnsontr(object$x, median(bb3$theta), 1e-32)
hist(yeojohnsontr(object$x, median(bb3$theta), 1e-32))
pars[8, ]
cc1
bb3$Mu
rowMeans(bb3$Mu)
plot(rowMeans(bb3$Mu))
plot(rowMeans(bb3$Mu), type = 'l')
plot(diff(rowMeans(bb3$Mu)), type = 'l')
bb3$Mu
dim(bb3$Mu)
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb1$Z[, 1]), as.matrix(bb1$Phi[, 1]),
bb1$mu0 + X1 %*% (bb1$Zeta * bb1$Beta) + H1 %*% (bb1$Tau * bb1$Gamma), bb1$sigma2[1],
1, bb1$theta[1], 1, 0, 1e-32)
bb1$mu0 + X1 %*% (bb1$Zeta * bb1$Beta) + H1 %*% (bb1$Tau * bb1$Gamma)
H1 %*% (bb1$Tau * bb1$Gamma)
H1 %*% (bb1$Tau[, 1] * bb1$Gamma[, 1])
bb1$Tau
bb3$mu0 + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]) + H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1]),
bb3$mu0 + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]) + H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1])
H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1])
X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1])
bb3$mu0[1] + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]) + H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1])
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb3$Z[, 1]), as.matrix(bb3$Phi[, 1]),
bb3$mu0[1] + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]),
bb1$sigma2[1],
1, bb1$theta[1], 1, 0, 1e-32)
cc1h9
cc1h0
plot(Y1)
plot(Y1, type = 'l')
points(cc1h0, type = 'l', col = 'red')
plot(Y1[-c(1:5)], type = 'l')
points(cc1h0, type = 'l', col = 'red')
plot(Y1[-c(1:5)], type = 'l')
for (i in 1:100) {
tmpsel <- sample(1:50, 1, TRUE)
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb3$Z[, tmpsel]), as.matrix(bb3$Phi[, tmpsel]),
bb3$mu0[tmpsel] + X1 %*% (bb3$Zeta[, tmpsel] * bb3$Beta[, tmpsel]),
bb1$sigma2[tmpsel],
1, bb1$theta[tmpsel], 1, 0, 1e-32)
points(cc1h0, type = 'l', col = 'red')
}
points(Y1[-c(1:5)], type = 'l')
plot(Y1[-c(1:5)], type = 'l')
for (i in 1:1000) {
tmpsel <- sample(1:50, 1, TRUE)
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb3$Z[, tmpsel]), as.matrix(bb3$Phi[, tmpsel]),
bb3$mu0[tmpsel] + X1 %*% (bb3$Zeta[, tmpsel] * bb3$Beta[, tmpsel]),
bb1$sigma2[tmpsel],
1, bb1$theta[tmpsel], 1, 0, 1e-32)
points(cc1h0, type = 'l', col = 'red')
}
points(Y1[-c(1:5)], type = 'l')
Rcpp::compileAttributes()
roxygen2::roxygenise()
bb3 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"MT", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
0, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb3$Z
Rcpp::compileAttributes()
roxygen2::roxygenise()
roxygen2::roxygenise()
remove.packages("BayesianLASSOMonitoring")
devtools::install_github("bolus123/BayesianLASSOMonitoring", "with-transformation")
seed <- 12345
load(file = "/Users/yuihuiyao/Library/CloudStorage/Box-Box/2024 Spring/Temporal and Geographical Project for Opioid-overdose ER vistis/dataset/walker_OXYCODONE_model2.Rdat")
object <- walker_OXYCODONE_model2
nnsim <- 100
TT1 <- c(92, 183)
TT2 <- 365
w <- c(1, 3, 7, 14, 28)
#w <- 7
q <- 5
delta <- c(0, 1)
tt <- 0.5
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
pars
object <- walker_OXYCODONE_model2
nnsim <- 100
TT1 <- c(92, 183)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 1)
tt <- 0.5
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
pars
X <- 4
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Xf1 <- BayesianLASSOMonitoring::getXSeasonalityFS(w + TT1 + TT2 + 5000, 7, 2)
Xf2 <- BayesianLASSOMonitoring::getXSeasonalityFS(w + TT1 + TT2 + 5000, 30.4375, 5)
tmpdate <- as.Date("2017-01-01") + (-w + 1):(TT1 + TT2 + 5000)
businessday <- tis::isBusinessDay(tmpdate)
holiday <- tis::isHoliday(tmpdate)
Xreg <- cbind(Xf1, Xf2, businessday, holiday)
Xreg1 <- Xreg[1:(TT1 + TT2 + w - 1), ]
Y <- BayesianLASSOMonitoring::rarma(object, xreg = Xreg1, n = TT1 + TT2 + w - 1, h = ceiling(TT1 * tt) + w - 1, delta = delta)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(2, TT1 - q, 7)]
#H1 <- H1[, which(colSums(H1) >= 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
XX <- as.matrix(1:(TT1 + TT2 + 5000))
X1 <- as.matrix(XX[1:TT1, ])
X2 <- as.matrix(XX[(TT1 + 1):(TT1 + TT2), ])
X2sim <- as.matrix(XX[(TT1 + 1):(TT1 + 5000), ])
X1 <- cbind(X1, Xreg[1:TT1, ])
X2 <- cbind(X2, Xreg[(TT1 + 1):(TT1 + TT2), ])
bset1 <- list(
"method" = "regression",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(rep(1, 5), nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(rep(1, 17), nrow = 17),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatepenalty" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"rounding" = 0,
"lambda2" = NULL,
"theta" = NULL,
"tol" = 1e-32,
"nsim" = 100,
"thin" = 10,
"burnin" = 100
)
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
bset1 <- list(
"method" = "regression",
"mono" = 0,
"q" = 5,
"A" = diag(rep(1, 5), nrow = 5),
"bound0" = Inf,
"boundqplus1" = 0,
"xi2" = 0.1,
"theta1" = 1,
"theta2" = 1,
"a" = 1,
"b" = 1,
"alpha" = 1,
"beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"rounding" = 0,
"lambda2" = NULL,
"theta" = NULL,
"eps" = 1e-32,
"nsim" = 100,
"thin" = 10,
"burnin" = 100
)
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
remove.packages("BayesianLASSOMonitoring")
