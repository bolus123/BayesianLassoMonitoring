Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
5 + 1
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
dim(X1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb
Y1
Y1[8]
bb$Z[8, ]
hisT(bb$Z[8, ])
hist(bb$Z[8, ])
hist(bb$Z[127, ])
bb$theta
bb$Zeta
bb$Beta
bb$Zeta * bb$Beta
bb <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
NULL)
bb1 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
NULL)
bb2 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
H1)
bb3 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb$Gamma
bb$Zeta
bb$Tau
bb$Beta
bb1$Tau
bb1$Gamma
bb1$Zeta
bb1$Beta
bb2$Zeta
bb$Tau
bb2$Tau
bb2$Gamma
bb2$Zeta
bb2$Beta
cc <- simYph2(0, as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]),
as.matrix(bb$Mu[, 1]), bb$sigma2[1],
1, bb$theta[1], 1, 0, 1e-32)
cc
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- simYph2(0, as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]),
as.matrix(bb$Mu[, 1]), bb$sigma2[1],
1, bb$theta[1], 1, 0, 1e-32)
cc
source("~/Library/CloudStorage/Box-Box/2023 Summer/BayesianMonitoring/testcode.R")
cc1 <- simYph2(0, as.matrix(Y1), as.matrix(bb1$Z[, 1]), as.matrix(bb1$Phi[, 1]),
as.matrix(bb1$Mu[, 1]), bb1$sigma2[1],
1, bb1$theta[1], 1, 0, 1e-32)
cc1
cc1
plot(cc1)
plot(cc1)
plot(Y1)
points(cc1, col = 'red')
bb1$theta
plot(Y1, type = 'l')
points(cc1, col = 'red', type = 'l')
bb2$Gamma
bb2$Gamma * bb2$Tau
rowMeans(updatemu0MuX)
rowMeans(bb2$Gamma * bb2$Tau)
plot(bb2$Gamma * bb2$Tau)
plot(rowMeans(bb2$Gamma * bb2$Tau))
rowMeans(bb2$Mu + H1 %*% (bb2$Gamma * bb2$Tau)))
rowMeans(bb2$Mu + H1 %*% (bb2$Gamma * bb2$Tau))
plot(rowMeans(bb2$Mu + H1 %*% (bb2$Gamma * bb2$Tau)))
object$coef
object$coef
bb2$Phi[1, ]
hist(bb2$Phi[1, ])
hist(bb2$Phi[1, ])
bb2$mu0
object$coef
rowMeans(bb2$Zeta * bb2$Beta)
rowMeans(bb3$Zeta * bb3$Beta)
hist(object$x)
yeojohntr(hist(object$x), median(bb3$theta), 1e-32)
yeojohnsontr(object$x, median(bb3$theta), 1e-32)
hist(yeojohnsontr(object$x, median(bb3$theta), 1e-32))
pars[8, ]
cc1
bb3$Mu
rowMeans(bb3$Mu)
plot(rowMeans(bb3$Mu))
plot(rowMeans(bb3$Mu), type = 'l')
plot(diff(rowMeans(bb3$Mu)), type = 'l')
bb3$Mu
dim(bb3$Mu)
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb1$Z[, 1]), as.matrix(bb1$Phi[, 1]),
bb1$mu0 + X1 %*% (bb1$Zeta * bb1$Beta) + H1 %*% (bb1$Tau * bb1$Gamma), bb1$sigma2[1],
1, bb1$theta[1], 1, 0, 1e-32)
bb1$mu0 + X1 %*% (bb1$Zeta * bb1$Beta) + H1 %*% (bb1$Tau * bb1$Gamma)
H1 %*% (bb1$Tau * bb1$Gamma)
H1 %*% (bb1$Tau[, 1] * bb1$Gamma[, 1])
bb1$Tau
bb3$mu0 + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]) + H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1]),
bb3$mu0 + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]) + H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1])
H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1])
X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1])
bb3$mu0[1] + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]) + H1 %*% (bb3$Tau[, 1] * bb3$Gamma[, 1])
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb3$Z[, 1]), as.matrix(bb3$Phi[, 1]),
bb3$mu0[1] + X1 %*% (bb3$Zeta[, 1] * bb3$Beta[, 1]),
bb1$sigma2[1],
1, bb1$theta[1], 1, 0, 1e-32)
cc1h9
cc1h0
plot(Y1)
plot(Y1, type = 'l')
points(cc1h0, type = 'l', col = 'red')
plot(Y1[-c(1:5)], type = 'l')
points(cc1h0, type = 'l', col = 'red')
plot(Y1[-c(1:5)], type = 'l')
for (i in 1:100) {
tmpsel <- sample(1:50, 1, TRUE)
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb3$Z[, tmpsel]), as.matrix(bb3$Phi[, tmpsel]),
bb3$mu0[tmpsel] + X1 %*% (bb3$Zeta[, tmpsel] * bb3$Beta[, tmpsel]),
bb1$sigma2[tmpsel],
1, bb1$theta[tmpsel], 1, 0, 1e-32)
points(cc1h0, type = 'l', col = 'red')
}
points(Y1[-c(1:5)], type = 'l')
plot(Y1[-c(1:5)], type = 'l')
for (i in 1:1000) {
tmpsel <- sample(1:50, 1, TRUE)
cc1h0 <- simYph2(0, as.matrix(Y1), as.matrix(bb3$Z[, tmpsel]), as.matrix(bb3$Phi[, tmpsel]),
bb3$mu0[tmpsel] + X1 %*% (bb3$Zeta[, tmpsel] * bb3$Beta[, tmpsel]),
bb1$sigma2[tmpsel],
1, bb1$theta[tmpsel], 1, 0, 1e-32)
points(cc1h0, type = 'l', col = 'red')
}
points(Y1[-c(1:5)], type = 'l')
Rcpp::compileAttributes()
roxygen2::roxygenise()
bb3 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"MT", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
0, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb3$Z
