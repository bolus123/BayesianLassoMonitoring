TT1 <- c(92, 183)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 1)
tt <- 0.5
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
X <- 4
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Xf1 <- BayesianLASSOMonitoring::getXSeasonalityFS(w + TT1 + TT2 + 5000, 7, 2)
Xf2 <- BayesianLASSOMonitoring::getXSeasonalityFS(w + TT1 + TT2 + 5000, 30.4375, 5)
tmpdate <- as.Date("2017-01-01") + (-w + 1):(TT1 + TT2 + 5000)
businessday <- tis::isBusinessDay(tmpdate)
holiday <- tis::isHoliday(tmpdate)
Xreg <- cbind(Xf1, Xf2, businessday, holiday)
Xreg1 <- Xreg[1:(TT1 + TT2 + w - 1), ]
Y <- BayesianLASSOMonitoring::rarma(object, xreg = Xreg1, n = TT1 + TT2 + w - 1, h = ceiling(TT1 * tt) + w - 1, delta = delta)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(2, TT1 - q, 7)]
#H1 <- H1[, which(colSums(H1) >= 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
XX <- as.matrix(1:(TT1 + TT2 + 5000))
X1 <- as.matrix(XX[1:TT1, ])
X2 <- as.matrix(XX[(TT1 + 1):(TT1 + TT2), ])
X2sim <- as.matrix(XX[(TT1 + 1):(TT1 + 5000), ])
X1 <- cbind(X1, Xreg[1:TT1, ])
X2 <- cbind(X2, Xreg[(TT1 + 1):(TT1 + TT2), ])
bset <- list(
"method" = "regression",
"mono" = 0,
"q" = 5,
"A" = diag(rep(1, 5), nrow = 5),
"bound0" = Inf,
"boundqplus1" = 0,
"xi2" = 0.1,
"theta1" = 1,
"theta2" = 1,
"a" = 1,
"b" = 1,
"alpha" = 1,
"beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"rounding" = 0,
"lambda2" = NULL,
"theta" = 1,
"eps" = 1e-32,
"nsim" = 100,
"thin" = 10,
"burnin" = 100
)
##############################################
bb <- BayesianLASSOMonitoring::GibbsRFLSMXYJZ(as.matrix(Y1), bset, X1, H1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(Y1, bb$Z[, 1], bb$Phi[, 1], bb$Mu[, 1], bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cc
as.matrix(bb$Z[, 1])
as.matrix(bb$Phi[, 1])
as.matrix(Y1)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cc
as.matrix(bb$Z[, 1])
cbind(as.matrix(bb$Z[, 1]), cc)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cc
cbind(bb$Z[, 1], cc)
invyeojohnsontr(-Inf, 1, 1e-32)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
cc <- updateZSim(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cc
cbind(bb, cc)
cbind(bb$Z[, 1], cc)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
dd <- updateZ0(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding, 0, 1 bset$eps)
dd <- updateZ0(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding, 0, 1, bset$eps)
dd <- updateZ0(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$leftcensoring, bset$rounding, 0, 1, bset$eps)
dd
dd <- updateZ0(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$leftcensoring, bset$rounding, 0, 1, bset$eps)
dd
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
dd <- updateZ0(as.matrix(Y1), as.matrix(bb$Z[, 1]), as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$leftcensoring, bset$rounding, 0, 1, bset$eps)
dd
cbind(bb$Z[, 1], dd)
cc <- updateZSim(as.matrix(Y1), dd, as.matrix(bb$Phi[, 1]), as.matrix(bb$Mu[, 1]), bb$sigma2[1],
bb$theta[1], bset$eps, bset$leftcensoring, bset$rounding)
cbind(bb$Z[, 1], dd, cc)
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
bb <- GibbsRFLSMXYJZcpp1(as.matrix(Y1), bset$q, bset$A, bset$a, bset$b, bset$alpha, bset$beta,
bset$theta1, bset$theta2, bset$xi2,
bset$method, bset$mono, bset$bound0, bset$boundqplus1,
bset$updateYJ, bset$theta,
bset$leftcensoring, bset$rounding, bset$eps,
bset$nsim, bset$thin, bset$burnin,
bset$eps,
NULL,
NULL,
X1,
H1)
bb$theta
bb$Z
plot(bb$Z)
plot(bb$Z[1, ])
hist(bb$Z[1, ])
hist(bb$Z[2, ])
hist(bb$Z[7, ])
hist(bb$Z[8, ])
seed <- 12345
alpha <- c(0.03083069, 0.06242601, 0.09120189)
lambda <- 0.239385
pi <- 0.1453097
nnsim <- 100
TT1 <- c(92, 183)
#TT1 <- c(92)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 0.5, 1)
tt <- 0.8
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
X <- 6
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2, alpha, lambda, pi,
ceiling(TT1 * tt), delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
##############################################
bset <- list(
"method" = "regression",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(rep(1, 5), nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(rep(1, 17), nrow = 17),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatepenalty" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL,
"tol" = 1e-32,
"nsim" = 100,
"thin" = 10,
"burnin" = 100
)
##############################################
bb <- GibbsRFLSMXYJZcpp1(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 1, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
H1)
bb$theta
bb$Z[1, ]
plot(bb$Z[1, ])
hist(bb$Z[1, ])
hist(bb$Z[2, ])
hist(bb$Z[3, ])
hist(bb$Z[4, ])
hist(bb$Z[5, ])
hist(bb$Z[6, ])
hist(bb$Z[7, ])
hist(bb$Z[8, ])
hist(bb$Z[9, ])
hist(bb$Z[10, ])
hist(bb$Z[11, ])
bb$mu0
Rcpp::sourceCpp("src/BayesianLASSOMonitoring.cpp")
seed <- 12345
alpha <- c(0.03083069, 0.06242601, 0.09120189)
lambda <- 0.239385
pi <- 0.1453097
nnsim <- 100
TT1 <- c(92, 183)
#TT1 <- c(92)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 0.5, 1)
tt <- 0.8
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
X <- 6
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2, alpha, lambda, pi,
ceiling(TT1 * tt), delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
##############################################
bset <- list(
"method" = "regression",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(rep(1, 5), nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(rep(1, 17), nrow = 17),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatepenalty" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL,
"tol" = 1e-32,
"nsim" = 100,
"thin" = 10,
"burnin" = 100
)
##############################################
bb <- GibbsRFLSMXYJZcpp1(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 1, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
H1)
bb$theta
hist(bb$theta)
bb$Z
bb$Z[1, ]
hist(bb$Z[1, ])
hist(bb$Z[2, ])
hist(bb$Z[3, ])
hist(bb$Z[4, ])
hist(bb$Z[5, ])
hist(bb$Z[6, ])
hist(bb$Z[7, ])
hist(bb$Z[8, ])
hist(bb$Z[9, ])
hist(bb$Z[10, ])
hist(bb$Z[11, ])
hist(bb$Z[12, ])
hist(bb$Z[13, ])
hist(bb$Z[14, ])
hist(bb$Z[15, ])
hist(bb$Z[16, ])
hist(bb$Z[17, ])
hist(bb$Z[18, ])
hist(bb$Z[19, ])
hist(bb$Z[20, ])
hist(bb$Z[21, ])
hist(bb$Z[22, ])
hist(bb$Z[23, ])
hist(bb$Z[24, ])
hist(bb$Z[25, ])
Y1
Y1 + bb$Z[1, ]
Y1[1] + bb$Z[1, ]
hist(Y1[1] + bb$Z[1, ])
hist(Y1[2] + bb$Z[2, ])
Y1
hist(Y1[3] + bb$Z[3, ])
hist(Y1[4] + bb$Z[4, ])
hist(Y1[6] + bb$Z[6, ])
hist(Y1[7] + bb$Z[7, ])
hist(Y1[109] + bb$Z[109, ])
hist(Y1[110] + bb$Z[110, ])
bb3 <- GibbsRFLSMXYJZcpp(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"MT", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 0, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
X1,
H1)
bb <- GibbsRFLSMXYJZcpp1(as.matrix(Y1), bset$q, bset$A, bset$a, bset$b, bset$alpha, bset$beta,
bset$theta1, bset$theta2, bset$xi2,
bset$method, bset$mono, bset$bound0, bset$boundqplus1,
bset$updateYJ, bset$theta,
bset$leftcensoring, bset$rounding, bset$eps,
bset$nsim, bset$thin, bset$burnin,
bset$eps,
NULL,
NULL,
X1,
H1)
bb <- GibbsRFLSMXYJZcpp1(as.matrix(Y1), bset$q, bset$A, bset$a, bset$b, bset$alpha, bset$beta,
bset$theta1, bset$theta2, bset$xi2,
bset$method, bset$mono, bset$bound0, bset$boundqplus1,
bset$updateYJ, bset$theta,
bset$leftcensoring, bset$rounding, bset$eps,
bset$nsim, bset$thin, bset$burnin,
bset$eps,
NULL,
NULL,
X1,
H1)
seed <- 12345
alpha <- c(0.03083069, 0.06242601, 0.09120189)
lambda <- 0.239385
pi <- 0.1453097
nnsim <- 100
TT1 <- c(92, 183)
#TT1 <- c(92)
TT2 <- 365
w <- c(1)
#w <- 7
q <- 5
delta <- c(0, 0.5, 1)
tt <- 0.8
Y.hat.method <- c("median")
side <- "right-sided"
FAP0 <- 0.2
log <- c(FALSE)
sta <- c(FALSE)
pars <- expand.grid(TT1, TT2, w, q, delta, tt, Y.hat.method, side, FAP0, log, sta, 1:nnsim)
X <- 6
set.seed(seed + X)
TT1 <- pars[X, 1]
TT2 <- pars[X, 2]
w <- pars[X, 3]
q <- pars[X, 4]
delta <- pars[X, 5]
tt <- pars[X, 6]
Y.hat.method <- as.character(pars[X, 7])
side <- as.character(pars[X, 8])
FAP0 <- pars[X, 9]
log <- pars[X, 10]
sta <- pars[X, 11]
Y <- BayesianLASSOMonitoring::rzinpoisinar3(TT1 + TT2, alpha, lambda, pi,
ceiling(TT1 * tt), delta = delta, burnin = 100)
Y0 <- Y[1:(w - 1)]
Y1 <- Y[w:(TT1 + w - 1)]
Y2 <- Y[(TT1 + w):(TT1 + TT2 + w - 1)]
#H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H2 <- matrix(1, nrow = TT2, ncol = TT1 - q)
#H2sim <- matrix(1, nrow = 5000, ncol = TT1 - q)
H1 <- BayesianLASSOMonitoring::getHMatMT(TT1, q)
#H1 <- H1[, seq(1, TT1 - q, 7)]
#H1 <- H1[, -c(colSums(H1) < 7)]
H2<- matrix(1, nrow = TT2, ncol = dim(H1)[2])
H2sim <- matrix(1, nrow = 5000, ncol = dim(H1)[2])
##############################################
bset <- list(
"method" = "regression",
"phimono" = 0,
"phiq" = 5,
"phiA" = diag(rep(1, 5), nrow = 5),
"phibound0" = Inf,
"phiboundqplus1" = 0,
"betaA" = diag(rep(1, 17), nrow = 17),
"gammaxi2" = 0.1,
"tautheta1" = 1,
"tautheta2" = 1,
"sigma2a" = 1,
"sigma2b" = 1,
"updatepenalty" = 1,
"lambda2alpha" = 1,
"lambda2beta" = 1,
"updateYJ" = 1,
"leftcensoring" = 1,
"rounding" = 1,
"lambda2" = NULL,
"theta" = NULL,
"tol" = 1e-32,
"nsim" = 100,
"thin" = 10,
"burnin" = 100
)
##############################################
bb <- GibbsRFLSMXYJZcpp1(Y1, bset$phiq,
bset$phiA, bset$sigma2a, bset$sigma2b, bset$lambda2alpha, bset$lambda2beta,
bset$tautheta1, bset$tautheta2, bset$gammaxi2,
"LASSO", 1, bset$phibound0, bset$phiboundqplus1,
1, 1,
1, 1, bset$tol,
50, 10, 500,
bset$tol,
NULL,
NULL,
NULL,
H1)
bb$Z
Rcpp::compileAttributes()
roxygen2::roxygenise()
roxygen2::roxygenise()
